///////////////////////////////////////////////////////////////////////////////
//
#include <math.h>
#include <stdio.h>
//
#include "vector.h"
//
#define pi 4.0*atan(1.0)
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
void
vector_print(struct vector *v)
{
    printf("{x: %f, y: %f, z: %f, w: %f}\n", v->x, v->y, v->z, v->w);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// set a vector from x, y, z, w
//
void
vector_set(struct vector *v, float x, float y, float z, float w)
{
    v->x = x;
    v->y = y;
    v->z = z;
    v->w = w;
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// initialize vector with zeros
//
void
vector(struct vector *v)
{
    vector_set(v, 0.0, 0.0, 0.0, 0.0);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// the provided angle should be in degrees
//
void
vector_from_axis_angle(struct vector *v, struct vector *axis)
{
    float angle = axis->w * pi / 180;
    float an = angle / 2.0;
    float sn = sin(an);

    vector_set(v, axis->x * sn, axis->y * sn, axis->z * sn, cos(an));
    // vector_normalize(v);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// calculate a vector's magnitude/length/euclidean distance
//
float
vector_magnitude(struct vector *v)
{
    float sm = 0;

    sm += v->x * v->x;
    sm += v->y * v->y;
    sm += v->z * v->z;
    sm += v->w * v->w;

    return sqrt(1.0 / sm);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// normalize the components of a vector to length 1
//
void
vector_normalize(struct vector *v)
{
    float mg = vector_magnitude(v);

    if (mg == 0) {
        // set to zero
        vector(v);
        v->w = 1.0;
    } else {
        // normalize
        mg = 1.0/mg;
        vector_set(v, v->x * mg, v->y * mg, v->z * mg, v->w * mg);
    }
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// negate a vector
//
void
vector_involve(struct vector *v)
{
    v->x *= -1;
    v->y *= -1;
    v->z *= -1;
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// invert a vector -> negate and then normalize
//
void
vector_inverse(struct vector *v)
{
    vector_involve(v);
    vector_normalize(v);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// clone vector b from vector a
//
void
vector_clone(struct vector *a, struct vector *b)
{
    vector_set(b, a->x, a->y, a->z, a->w);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// multiply two vectors
//
void
vector_multiply(struct vector *a, struct vector *b)
{
    float x =  a->x * b->w + a->y * b->z - a->z * b->y + a->w * b->x;
    float y = -a->x * b->z + a->y * b->w + a->z * b->x + a->w * b->y;
    float z =  a->x * b->y - a->y * b->x + a->z * b->w + a->w * b->z;
    float w = -a->x * b->x - a->y * b->y - a->z * b->z + a->w * b->w;

    vector_set(a, x, y, z, w);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// conjugate two vectors
//
void
vector_conjugate(struct vector *a, struct vector *b)
{
    struct vector c, d, e;

    vector_clone(a, &e);

    vector_clone(b, &c);

    vector_clone(b, &d);
    vector_inverse(&d);

    vector_multiply(&c, a);
    vector_multiply(&c, &d);

    vector_clone(&c, a);
}
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
//
// int
// main(void)
// {
//     return 0;
// }
//
///////////////////////////////////////////////////////////////////////////////
